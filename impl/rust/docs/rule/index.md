# rule モジュール

## 規則要素

規則及びそれに付随する要素について解説する。

### 要素への ID

それぞれのブロックや規則を識別するため、それらの要素には ID が割り振られる。

#### ブロック ID

ブロックを識別する文字列。

`ファイルエイリアス名.ブロック名` という形式。

#### 規則 ID

規則を識別する文字列。

基本的に `ファイルエイリアス名.ブロック名.規則名` という形式。

ただしプリミティブ規則の場合は `規則名` となる。

#### UUID

[グループ](#グループ) を識別する [uuid::Uuid](https://docs.rs/uuid/latest/uuid/) インスタンス。

### マップデータ

規則, ブロック内の要素をまとめて管理するためハッシュマップを利用する。

#### ブロックマップ

[命令](#命令) をブロックごとにまとめたマップ。

中身データの構造は `HashMap<ブロック名, 規則>` となっている。

#### 規則マップ

ブロックマップ内の全規則を展開したマップ。

中身データの構造は `HashMap<規則ID, 規則>` となっている。

### ブロックデータ

#### ブロック

- `name` ... ブロック名
- `cmds` ... ブロックが持つ命令一覧

### 規則データ

#### 規則

- `pos` ... 規則が定義された位置
- `id` ... 規則 ID
- `name` ... 規則名
- `generics_arg_ids` ... ジェネリクスの仮引数一覧
- `template_arg_ids` ... テンプレートの仮引数一覧
- `group` ... 構文として定義されたグループ要素

#### グループ

選択もしくは連接を表す要素。

- `uuid` ... グループ固有の UUID
- `kind` ... グループの種別 (選択もしくは連接)
- `sub_elems` ... グループが持つ [規則](#規則) 要素
- `ast_reflection_style` ... AST 反映方式
- `lookahead_kind` ... 先読み方式
- `loop_range` ... 繰り返しの範囲
- `elem_order` ... 要素順序の指定 (順序的もしくは順不同)
